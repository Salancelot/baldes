<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BALDES: ExactRCC.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BALDES
   </div>
   <div id="projectbrief">Bucket Graph Labeling Algorithm for Vehicle Routing</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('ExactRCC_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ExactRCC.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="Definitions_8h_source.html">Definitions.h</a>&quot;</code><br />
<code>#include &quot;gurobi_c++.h&quot;</code><br />
<code>#include &quot;gurobi_c.h&quot;</code><br />
<code>#include &quot;<a class="el" href="Hashes_8h_source.html">Hashes.h</a>&quot;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;set&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ExactRCC.h:</div>
<div class="dyncontent">
<div class="center"><img src="ExactRCC_8h__incl.png" border="0" usemap="#aExactRCC_8h" alt=""/></div>
<map name="aExactRCC_8h" id="aExactRCC_8h">
<area shape="rect" title=" " alt="" coords="2408,5,2498,31"/>
<area shape="rect" href="Definitions_8h.html" title="Header file containing definitions and structures for the solver." alt="" coords="1544,79,1636,105"/>
<area shape="poly" title=" " alt="" coords="2407,26,1652,88,1651,83,2407,21"/>
<area shape="rect" href="Hashes_8h.html" title=" " alt="" coords="5,234,82,260"/>
<area shape="poly" title=" " alt="" coords="2407,25,1722,67,1207,106,674,155,510,169,381,179,254,194,93,229,86,231,85,226,92,224,253,189,381,173,509,164,674,150,1206,100,1722,61,2407,19"/>
<area shape="rect" title=" " alt="" coords="2155,234,2212,260"/>
<area shape="poly" title=" " alt="" coords="2408,34,2360,50,2305,75,2251,110,2226,131,2206,154,2191,186,2186,219,2181,218,2186,184,2201,151,2223,127,2247,105,2302,70,2358,45,2406,29"/>
<area shape="rect" title=" " alt="" coords="2325,234,2396,260"/>
<area shape="poly" title=" " alt="" coords="2450,32,2430,80,2374,220,2369,218,2425,78,2445,30"/>
<area shape="rect" title=" " alt="" coords="2420,234,2488,260"/>
<area shape="poly" title=" " alt="" coords="2451,32,2438,79,2436,117,2438,154,2450,218,2444,219,2433,155,2431,117,2433,79,2446,31"/>
<area shape="rect" title=" " alt="" coords="2447,79,2544,105"/>
<area shape="poly" title=" " alt="" coords="2462,30,2483,64,2478,67,2458,33"/>
<area shape="rect" title=" " alt="" coords="2567,79,2648,105"/>
<area shape="poly" title=" " alt="" coords="2480,29,2569,70,2566,75,2478,34"/>
<area shape="rect" title=" " alt="" coords="2672,79,2730,105"/>
<area shape="poly" title=" " alt="" coords="2496,29,2658,75,2657,81,2494,34"/>
<area shape="rect" title=" " alt="" coords="2753,79,2792,105"/>
<area shape="poly" title=" " alt="" coords="2499,24,2605,44,2739,76,2738,81,2604,49,2498,29"/>
<area shape="rect" title=" " alt="" coords="2816,79,2927,105"/>
<area shape="poly" title=" " alt="" coords="2499,25,2801,76,2800,81,2498,30"/>
<area shape="rect" href="Common_8h.html" title=" " alt="" coords="1086,153,1169,178"/>
<area shape="poly" title=" " alt="" coords="1545,103,1185,158,1184,153,1544,98"/>
<area shape="rect" title=" " alt="" coords="106,234,275,260"/>
<area shape="poly" title=" " alt="" coords="1545,99,1037,141,667,180,288,229,263,233,262,228,287,224,667,174,1036,136,1544,94"/>
<area shape="rect" href="SparseMatrix_8h.html" title=" " alt="" coords="2215,153,2322,178"/>
<area shape="poly" title=" " alt="" coords="1637,95,2200,154,2199,160,1636,101"/>
<area shape="rect" title=" " alt="" coords="1644,234,1710,260"/>
<area shape="poly" title=" " alt="" coords="1170,165,1255,169,1371,178,1502,196,1633,224,1639,225,1638,231,1632,229,1502,201,1371,184,1255,174,1169,170"/>
<area shape="rect" title=" " alt="" coords="1733,234,1882,260"/>
<area shape="poly" title=" " alt="" coords="1170,167,1405,185,1563,202,1723,224,1743,227,1742,233,1722,229,1562,207,1405,190,1169,172"/>
<area shape="poly" title=" " alt="" coords="1086,170,887,175,599,185,306,203,185,215,93,229,85,231,84,226,92,224,184,209,306,197,599,180,887,169,1086,165"/>
<area shape="rect" title=" " alt="" coords="1905,226,2032,267"/>
<area shape="poly" title=" " alt="" coords="1170,165,1291,169,1467,178,1675,195,1890,223,1889,228,1674,201,1467,183,1291,174,1170,170"/>
<area shape="rect" title=" " alt="" coords="300,234,449,260"/>
<area shape="poly" title=" " alt="" coords="1086,171,822,189,643,206,461,229,440,233,439,228,460,224,642,200,821,183,1085,166"/>
<area shape="rect" title=" " alt="" coords="473,234,550,260"/>
<area shape="poly" title=" " alt="" coords="1086,170,991,174,860,184,712,201,563,229,555,231,554,226,562,224,711,196,860,178,991,169,1085,165"/>
<area shape="rect" title=" " alt="" coords="2057,234,2131,260"/>
<area shape="poly" title=" " alt="" coords="1170,165,1602,182,1859,199,1965,211,2045,224,2053,226,2052,231,2044,229,1964,216,1858,205,1602,187,1170,171"/>
<area shape="rect" title=" " alt="" coords="574,234,623,260"/>
<area shape="poly" title=" " alt="" coords="1085,169,1001,172,888,181,761,199,697,212,635,229,632,230,631,225,633,224,696,207,760,193,887,175,1001,167,1085,164"/>
<area shape="rect" title=" " alt="" coords="647,234,707,260"/>
<area shape="poly" title=" " alt="" coords="1086,172,924,188,822,205,720,229,716,230,714,225,719,224,821,200,923,183,1085,167"/>
<area shape="rect" title=" " alt="" coords="731,234,788,260"/>
<area shape="poly" title=" " alt="" coords="1086,174,957,192,879,208,802,229,798,230,796,225,800,224,878,203,956,187,1085,168"/>
<area shape="rect" title=" " alt="" coords="812,234,878,260"/>
<area shape="poly" title=" " alt="" coords="1086,178,996,199,891,229,887,230,885,225,889,224,994,194,1085,173"/>
<area shape="rect" title=" " alt="" coords="902,234,956,260"/>
<area shape="poly" title=" " alt="" coords="1093,181,970,229,968,230,966,225,968,224,1092,177"/>
<area shape="rect" title=" " alt="" coords="980,234,1027,260"/>
<area shape="poly" title=" " alt="" coords="1110,181,1037,228,1034,223,1107,177"/>
<area shape="rect" title=" " alt="" coords="1051,234,1118,260"/>
<area shape="poly" title=" " alt="" coords="1123,180,1101,221,1096,219,1119,177"/>
<area shape="rect" title=" " alt="" coords="1142,234,1198,260"/>
<area shape="poly" title=" " alt="" coords="1136,177,1159,219,1154,221,1132,180"/>
<area shape="rect" title=" " alt="" coords="1223,234,1283,260"/>
<area shape="poly" title=" " alt="" coords="1148,176,1222,223,1219,228,1145,181"/>
<area shape="poly" title=" " alt="" coords="1170,164,1366,168,1649,177,1936,194,2055,207,2144,224,2149,225,2147,230,2143,229,2054,213,1935,200,1649,182,1366,173,1170,170"/>
<area shape="poly" title=" " alt="" coords="1085,171,755,186,523,203,288,229,261,233,261,228,287,224,523,198,754,181,1085,165"/>
<area shape="rect" title=" " alt="" coords="1306,234,1410,260"/>
<area shape="poly" title=" " alt="" coords="1164,176,1309,226,1308,231,1162,181"/>
<area shape="rect" title=" " alt="" coords="1434,234,1517,260"/>
<area shape="poly" title=" " alt="" coords="1170,171,1285,192,1423,224,1430,226,1429,231,1421,229,1284,197,1169,176"/>
<area shape="rect" title=" " alt="" coords="1541,234,1620,260"/>
<area shape="poly" title=" " alt="" coords="1170,168,1329,186,1429,202,1529,224,1537,226,1536,231,1528,229,1428,207,1328,191,1169,173"/>
<area shape="poly" title=" " alt="" coords="2243,181,2136,230,2133,225,2241,176"/>
<area shape="poly" title=" " alt="" coords="2258,181,2209,225,2206,221,2254,177"/>
<area shape="rect" title=" " alt="" coords="2237,234,2301,260"/>
<area shape="poly" title=" " alt="" coords="2272,179,2272,218,2266,218,2266,179"/>
<area shape="poly" title=" " alt="" coords="2285,177,2337,222,2334,226,2281,181"/>
<area shape="poly" title=" " alt="" coords="2298,176,2413,225,2411,230,2296,181"/>
</map>
</div>
</div>
<p><a href="ExactRCC_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6d537da72ef7bd98e97c61ff256d3006" id="r_a6d537da72ef7bd98e97c61ff256d3006"><td class="memItemLeft" align="right" valign="top">std::vector&lt; set&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d537da72ef7bd98e97c61ff256d3006">separate_Rounded_Capacity_cuts</a> (GRBModel *gurobi_model, int Q, const std::vector&lt; int &gt; &amp;demand, const std::vector&lt; <a class="el" href="structPath.html">Path</a> &gt; &amp;allPaths, const std::vector&lt; double &gt; &amp;sol)</td></tr>
<tr class="memdesc:a6d537da72ef7bd98e97c61ff256d3006"><td class="mdescLeft">&#160;</td><td class="mdescRight">Separates Rounded Capacity Cuts (RCC) for a given Gurobi model.  <br /></td></tr>
<tr class="separator:a6d537da72ef7bd98e97c61ff256d3006"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6d537da72ef7bd98e97c61ff256d3006" name="a6d537da72ef7bd98e97c61ff256d3006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d537da72ef7bd98e97c61ff256d3006">&#9670;&#160;</a></span>separate_Rounded_Capacity_cuts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; set&lt; int &gt; &gt; separate_Rounded_Capacity_cuts </td>
          <td>(</td>
          <td class="paramtype">GRBModel *</td>          <td class="paramname"><span class="paramname"><em>gurobi_model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>Q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>demand</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structPath.html">Path</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>allPaths</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>sol</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Separates Rounded Capacity Cuts (RCC) for a given Gurobi model. </p>
<p>This function identifies and separates RCCs from a given Gurobi model. It uses the solution from the LP or relaxed problem and searches for multiple solutions that violate the RCC constraints. The function returns multiple sets of nodes corresponding to the solutions found. </p>

<p class="definition">Definition at line <a class="el" href="ExactRCC_8h_source.html#l00046">46</a> of file <a class="el" href="ExactRCC_8h_source.html">ExactRCC.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                                                          {</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordtype">double</span>                     epsilon_1         = 0.5;</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordtype">double</span>                     epsilon_2         = 1e-2;</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordtype">double</span>                     epsilon_3         = 1e-3;</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordtype">int</span>                        iteration_counter = 0;</div>
<div class="line"><span class="lineno">   54</span>    unordered_map&lt;int, GRBVar&gt; delta;</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordtype">bool</span>                       need_to_run_RCC_separation = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">// Solution from the LP or relaxed problem</span></div>
<div class="line"><span class="lineno">   57</span>    <span class="comment">// std::vector&lt;double&gt; sol;</span></div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// int                 varNumber = gurobi_model-&gt;get(GRB_IntAttr_NumVars);</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">// for (int i = 0; i &lt; varNumber; i++) { sol.push_back(gurobi_model-&gt;getVar(i).get(GRB_DoubleAttr_X)); }</span></div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    vector&lt;double&gt; x_values     = sol;</div>
<div class="line"><span class="lineno">   62</span>    GRBModel       m_separation = GRBModel(gurobi_model-&gt;getEnv());</div>
<div class="line"><span class="lineno">   63</span>    m_separation.set(GRB_IntParam_OutputFlag, 0);</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    <span class="comment">// Enable Gurobi to search for multiple solutions</span></div>
<div class="line"><span class="lineno">   66</span>    m_separation.set(GRB_IntParam_PoolSearchMode, 2);</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">// Set the number of solutions to be found</span></div>
<div class="line"><span class="lineno">   69</span>    m_separation.set(GRB_IntParam_PoolSolutions, 5);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    GRBVar alpha = m_separation.addVar(0, GRB_INFINITY, 0, GRB_INTEGER);</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    set&lt;pair&lt;int, int&gt;&gt;                   relevant_edges;</div>
<div class="line"><span class="lineno">   74</span>    unordered_map&lt;pair&lt;int, int&gt;, <span class="keywordtype">double</span>&gt; edge_capacities;</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    unordered_map&lt;pair&lt;int, int&gt;, GRBVar&gt; gamma;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    std::vector&lt;std::vector&lt;double&gt;&gt; aijs(N_SIZE + 2, std::vector&lt;double&gt;(N_SIZE + 2, 0.0));</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter = 0; counter &lt; sol.size(); ++counter) {</div>
<div class="line"><span class="lineno">   81</span>        <span class="keyword">auto</span> &amp;nodes = allPaths[counter].route;</div>
<div class="line"><span class="lineno">   82</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; nodes.size(); ++k) {</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>            <span class="keywordtype">int</span> source = nodes[k - 1];</div>
<div class="line"><span class="lineno">   85</span>            <span class="keywordtype">int</span> target = (nodes[k] == N_SIZE - 1) ? 0 : nodes[k];</div>
<div class="line"><span class="lineno">   86</span>            aijs[source][target] += sol[counter];</div>
<div class="line"><span class="lineno">   87</span>        }</div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; N_SIZE - 1; ++i) {</div>
<div class="line"><span class="lineno">   90</span>        delta[i] = m_separation.addVar(0, 1, 0, GRB_BINARY);</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; N_SIZE - 1; ++j) {</div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordtype">double</span> edge_capacity = aijs[i][j];</div>
<div class="line"><span class="lineno">   93</span>            <span class="keywordflow">if</span> (edge_capacity &gt;= epsilon_2) {</div>
<div class="line"><span class="lineno">   94</span>                relevant_edges.insert({i, j});</div>
<div class="line"><span class="lineno">   95</span>                edge_capacities[{i, j}] = edge_capacity;</div>
<div class="line"><span class="lineno">   96</span>                gamma[{i, j}]           = m_separation.addVar(0, GRB_INFINITY, 0, GRB_CONTINUOUS);</div>
<div class="line"><span class="lineno">   97</span>            }</div>
<div class="line"><span class="lineno">   98</span>        }</div>
<div class="line"><span class="lineno">   99</span>    }</div>
<div class="line"><span class="lineno">  100</span>    m_separation.update();</div>
<div class="line"><span class="lineno">  101</span>    <span class="comment">// compute gcd of demands</span></div>
<div class="line"><span class="lineno">  102</span>    <span class="keyword">auto</span> gcd = 1;</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; N_SIZE - 1; ++i) { gcd = std::gcd(gcd, demand[i]); }</div>
<div class="line"><span class="lineno">  104</span>    GRBLinExpr lhs = GRBLinExpr(0.3 + alpha * Q);</div>
<div class="line"><span class="lineno">  105</span>    GRBLinExpr rhs = 0.0;</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; N_SIZE - 1; ++i) { rhs += delta[i] * demand[i]; }</div>
<div class="line"><span class="lineno">  107</span>    m_separation.addConstr(lhs &lt;= rhs);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    GRBLinExpr obj_separation = 2 * alpha + 2;</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; N_SIZE - 1; ++i) {</div>
<div class="line"><span class="lineno">  112</span>        <span class="keywordtype">double</span> edge_capacity = aijs[i][0] + aijs[0][i];</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">if</span> (edge_capacity &gt;= epsilon_2) { obj_separation += -delta[i] * edge_capacity; }</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[i, j] : relevant_edges) {</div>
<div class="line"><span class="lineno">  117</span>        m_separation.addConstr(gamma[{i, j}] &lt;= delta[i]);</div>
<div class="line"><span class="lineno">  118</span>        m_separation.addConstr(gamma[{i, j}] &lt;= delta[j]);</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    m_separation.addConstr(</div>
<div class="line"><span class="lineno">  122</span>        std::accumulate(delta.begin(), delta.end(), GRBLinExpr(0),</div>
<div class="line"><span class="lineno">  123</span>                        [](GRBLinExpr sum, <span class="keyword">const</span> std::pair&lt;const int, GRBVar&gt; &amp;p) { <span class="keywordflow">return</span> sum + p.second; }) &gt;= 2);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    m_separation.setObjective(obj_separation - accumulate(relevant_edges.begin(), relevant_edges.end(), GRBLinExpr(0),</div>
<div class="line"><span class="lineno">  126</span>                                                          [&amp;](GRBLinExpr sum, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;edge) {</div>
<div class="line"><span class="lineno">  127</span>                                                              <span class="keywordtype">int</span> i = edge.first, j = edge.second;</div>
<div class="line"><span class="lineno">  128</span>                                                              <span class="keywordflow">return</span> sum + (delta[i] + delta[j] - 2 * gamma[{i, j}]) *</div>
<div class="line"><span class="lineno">  129</span>                                                                               edge_capacities[{i, j}];</div>
<div class="line"><span class="lineno">  130</span>                                                          }),</div>
<div class="line"><span class="lineno">  131</span>                              GRB_MAXIMIZE);</div>
<div class="line"><span class="lineno">  132</span>    m_separation.optimize();</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    std::vector&lt;std::set&lt;int&gt;&gt; multiple_solutions; <span class="comment">// Store multiple sets of nodes</span></div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordtype">int</span>    solCount          = m_separation.get(GRB_IntAttr_SolCount); <span class="comment">// Number of solutions found</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordtype">double</span> eps_for_violation = 1e-3;</div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// Retrieve multiple solutions</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> solIndex = 0; solIndex &lt; solCount; ++solIndex) {</div>
<div class="line"><span class="lineno">  140</span>        m_separation.set(GRB_IntParam_SolutionNumber, solIndex); <span class="comment">// Set the solution number</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="keyword">auto</span> solution = m_separation.get(GRB_DoubleAttr_ObjVal); <span class="comment">// Get the objective value for this solution</span></div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">if</span> (m_separation.get(GRB_DoubleAttr_PoolObjVal) &gt;= eps_for_violation) {</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span><span class="preprocessor">#ifdef VERBOSE</span></div>
<div class="line"><span class="lineno">  145</span>            fmt::print(<span class="stringliteral">&quot;RCC Violation {}; Objective value - {}\n&quot;</span>, solIndex + 1,</div>
<div class="line"><span class="lineno">  146</span>                       m_separation.get(GRB_DoubleAttr_ObjVal));</div>
<div class="line"><span class="lineno">  147</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>            std::set&lt;int&gt; S; <span class="comment">// Store nodes for this solution</span></div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>            <span class="comment">// Extract solution for this specific delta configuration</span></div>
<div class="line"><span class="lineno">  152</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; N_SIZE - 1; ++i) {</div>
<div class="line"><span class="lineno">  153</span>                <span class="keywordflow">if</span> (delta[i].get(GRB_DoubleAttr_Xn) &gt; 0.5) { <span class="comment">// Get solution value for this node in the current solution</span></div>
<div class="line"><span class="lineno">  154</span>                    S.insert(i);</div>
<div class="line"><span class="lineno">  155</span>                }</div>
<div class="line"><span class="lineno">  156</span>            }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>            <span class="comment">// Store the set of nodes for this solution</span></div>
<div class="line"><span class="lineno">  159</span>            multiple_solutions.push_back(S);</div>
<div class="line"><span class="lineno">  160</span>        }</div>
<div class="line"><span class="lineno">  161</span>    }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">return</span> multiple_solutions; <span class="comment">// Return all sets of nodes corresponding to the solutions</span></div>
<div class="line"><span class="lineno">  164</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_eb848a6d5577302b475c9b576c58ba0d.html">cuts</a></li><li class="navelem"><a class="el" href="ExactRCC_8h.html">ExactRCC.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
